{"title":"react-router-dom","uid":"50552075ed1d1cbaae410e21993db179","slug":"react-router-dom","date":"2021-04-06T14:27:28.383Z","updated":"2021-04-06T14:52:45.563Z","comments":true,"path":"api/articles/react-router-dom.json","keywords":null,"cover":"http://img-blog.csdnimg.cn/20200716163610402.jpg","content":"<h2 id=\"BrowserRouter\"><a href=\"#BrowserRouter\" class=\"headerlink\" title=\"BrowserRouter\"></a>BrowserRouter</h2><span id=\"more\"></span>\n\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> React, &#123; Component &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> Context <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./context&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">let</span> pushState = <span class=\"built_in\">window</span>.history.pushState;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">HashRouter</span> <span class=\"keyword\">extends</span> <span class=\"title\">Component</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"title\">constructor</span>(<span class=\"params\">props</span>)</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">super</span>(props);</span><br><span class=\"line\">    <span class=\"built_in\">this</span>.state = &#123;</span><br><span class=\"line\">      location: &#123; <span class=\"attr\">pathname</span>: <span class=\"built_in\">window</span>.location.pathname, <span class=\"attr\">state</span>: <span class=\"literal\">null</span> &#125;,</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"title\">componentDidMount</span>(<span class=\"params\"></span>)</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">window</span>.history.pushState = <span class=\"function\">(<span class=\"params\">state, title, url</span>) =&gt;</span> &#123;</span><br><span class=\"line\">      pushState.call(<span class=\"built_in\">window</span>.history, state, title, url);</span><br><span class=\"line\">      <span class=\"built_in\">window</span>.onpushstate.call(<span class=\"built_in\">this</span>, state, url);</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"built_in\">window</span>.onpopstate = <span class=\"function\">(<span class=\"params\">event</span>) =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"built_in\">this</span>.setState(&#123;</span><br><span class=\"line\">        location: &#123;</span><br><span class=\"line\">          ...this.state.location,</span><br><span class=\"line\">          pathname: <span class=\"built_in\">window</span>.location.pathname,</span><br><span class=\"line\">          state: event.state,</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">      &#125;);</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"built_in\">window</span>.onpushstate = <span class=\"function\">(<span class=\"params\">state, pathname</span>) =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"built_in\">this</span>.setState(&#123;</span><br><span class=\"line\">        location: &#123;</span><br><span class=\"line\">          ...this.state.location,</span><br><span class=\"line\">          pathname: pathname,</span><br><span class=\"line\">          state: state,</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">      &#125;);</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"title\">render</span>(<span class=\"params\"></span>)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> that = <span class=\"built_in\">this</span>;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> value = &#123;</span><br><span class=\"line\">      location: that.state.location,</span><br><span class=\"line\">      history: &#123;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"title\">push</span>(<span class=\"params\">to</span>)</span> &#123;</span><br><span class=\"line\">          <span class=\"comment\">/** 阻止跳转 */</span></span><br><span class=\"line\">          <span class=\"keyword\">if</span> (that.block) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">let</span> confirm = <span class=\"built_in\">window</span>.confirm(</span><br><span class=\"line\">              that.block(<span class=\"keyword\">typeof</span> to === <span class=\"string\">&#x27;object&#x27;</span> ? to : &#123; <span class=\"attr\">pathname</span>: to &#125;)</span><br><span class=\"line\">            );</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!confirm) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> to === <span class=\"string\">&#x27;object&#x27;</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">let</span> &#123; pathname, state &#125; = to;</span><br><span class=\"line\">            <span class=\"built_in\">window</span>.history.pushState(state, <span class=\"string\">&#x27;&#x27;</span>, pathname);</span><br><span class=\"line\">          &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"built_in\">window</span>.history.pushState(<span class=\"literal\">null</span>, <span class=\"string\">&#x27;&#x27;</span>, to);</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        <span class=\"function\"><span class=\"title\">block</span>(<span class=\"params\">message</span>)</span> &#123;</span><br><span class=\"line\">          that.block = message;</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (</span><br><span class=\"line\">      &lt;Context.Provider value=&#123;value&#125;&gt;&#123;<span class=\"built_in\">this</span>.props.children&#125;&lt;/Context.Provider&gt;</span><br><span class=\"line\">    );</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> HashRouter;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"context\"><a href=\"#context\" class=\"headerlink\" title=\"context\"></a>context</h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/** 暴露出整个库的context上下文  */</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> React <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> Context = React.createContext();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> Context;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"HashRouter\"><a href=\"#HashRouter\" class=\"headerlink\" title=\"HashRouter\"></a>HashRouter</h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> React, &#123; Component &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> Context <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./context&#x27;</span>;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">HashRouter</span> <span class=\"keyword\">extends</span> <span class=\"title\">Component</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"title\">constructor</span>(<span class=\"params\">props</span>)</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">super</span>(props);</span><br><span class=\"line\">    <span class=\"built_in\">this</span>.state = &#123;</span><br><span class=\"line\">      location: &#123; <span class=\"attr\">pathname</span>: <span class=\"built_in\">window</span>.location.hash.slice(<span class=\"number\">1</span>), <span class=\"attr\">state</span>: <span class=\"literal\">null</span> &#125;,</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"built_in\">this</span>.locationState = <span class=\"literal\">null</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"title\">componentDidMount</span>(<span class=\"params\"></span>)</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">window</span>.location.hash = <span class=\"built_in\">window</span>.location.hash || <span class=\"string\">&#x27;/&#x27;</span>;</span><br><span class=\"line\">    <span class=\"built_in\">window</span>.addEventListener(<span class=\"string\">&#x27;hashchange&#x27;</span>, <span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">      <span class=\"built_in\">this</span>.setState(&#123;</span><br><span class=\"line\">        location: &#123;</span><br><span class=\"line\">          ...this.state.location,</span><br><span class=\"line\">          pathname: <span class=\"built_in\">window</span>.location.hash.slice(<span class=\"number\">1</span>),</span><br><span class=\"line\">          state: <span class=\"built_in\">this</span>.locationState,</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">      &#125;);</span><br><span class=\"line\">    &#125;);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"title\">render</span>(<span class=\"params\"></span>)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> that = <span class=\"built_in\">this</span>;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> value = &#123;</span><br><span class=\"line\">      location: that.state.location,</span><br><span class=\"line\">      history: &#123;</span><br><span class=\"line\">        <span class=\"function\"><span class=\"title\">push</span>(<span class=\"params\">to</span>)</span> &#123;</span><br><span class=\"line\">          <span class=\"comment\">/** 阻止跳转 */</span></span><br><span class=\"line\">          <span class=\"keyword\">if</span> (that.block) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">let</span> confirm = <span class=\"built_in\">window</span>.confirm(</span><br><span class=\"line\">              that.block(<span class=\"keyword\">typeof</span> to === <span class=\"string\">&#x27;object&#x27;</span> ? to : &#123; <span class=\"attr\">pathname</span>: to &#125;)</span><br><span class=\"line\">            );</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!confirm) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (<span class=\"keyword\">typeof</span> to === <span class=\"string\">&#x27;object&#x27;</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">let</span> &#123; pathname, state &#125; = to;</span><br><span class=\"line\">            that.locationState = state;</span><br><span class=\"line\">            <span class=\"built_in\">window</span>.location.hash = pathname;</span><br><span class=\"line\">          &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            that.locationState = <span class=\"literal\">null</span>;</span><br><span class=\"line\">            <span class=\"built_in\">window</span>.location.hash = to;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        <span class=\"function\"><span class=\"title\">block</span>(<span class=\"params\">message</span>)</span> &#123;</span><br><span class=\"line\">          that.block = message;</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">      &#125;,</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> (</span><br><span class=\"line\">      &lt;Context.Provider value=&#123;value&#125;&gt;&#123;<span class=\"built_in\">this</span>.props.children&#125;&lt;/Context.Provider&gt;</span><br><span class=\"line\">    );</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> HashRouter;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Link\"><a href=\"#Link\" class=\"headerlink\" title=\"Link\"></a>Link</h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> React, &#123; Component &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> Context <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./context&#x27;</span>;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Link</span> <span class=\"keyword\">extends</span> <span class=\"title\">Component</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">static</span> contextType = Context;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"title\">constructor</span>(<span class=\"params\">props</span>)</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">super</span>(props);</span><br><span class=\"line\">    <span class=\"built_in\">this</span>.state = &#123;&#125;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"title\">render</span>(<span class=\"params\"></span>)</span> &#123;</span><br><span class=\"line\">    <span class=\"comment\">/** 注意合并上部传来的props */</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> (</span><br><span class=\"line\">      <span class=\"comment\">// eslint-disable-next-line jsx-a11y/anchor-is-valid</span></span><br><span class=\"line\">      &lt;a</span><br><span class=\"line\">        &#123;...this.props&#125;</span><br><span class=\"line\">        onClick=&#123;<span class=\"function\">() =&gt;</span> &#123;</span><br><span class=\"line\">          <span class=\"built_in\">this</span>.props.context.history.push(<span class=\"built_in\">this</span>.props.to);</span><br><span class=\"line\">        &#125;&#125;</span><br><span class=\"line\">      &gt;</span><br><span class=\"line\">        &#123;<span class=\"built_in\">this</span>.props.children&#125;</span><br><span class=\"line\">      &lt;/a&gt;</span><br><span class=\"line\">    );</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> Link;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * &lt;a href=&#123;`#$&#123;this.props.to&#125;`&#125;&gt;&#123;this.props.children&#125;&lt;/a&gt;;</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"MenuLink\"><a href=\"#MenuLink\" class=\"headerlink\" title=\"MenuLink\"></a>MenuLink</h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> React, &#123; Component &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> Route <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./Route&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> Link <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./Link&#x27;</span>;</span><br><span class=\"line\"><span class=\"comment\">/**自定义导航 正增加高亮属性 */</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/** Route渲染内容有三种方法 component render children */</span></span><br><span class=\"line\"><span class=\"comment\">// component render 路径匹配渲染</span></span><br><span class=\"line\"><span class=\"comment\">// children 都会渲染</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">MenuLink</span>(<span class=\"params\">&#123; to, exact, children &#125;</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> (</span><br><span class=\"line\">    &lt;Route</span><br><span class=\"line\">      path=&#123;to&#125;</span><br><span class=\"line\">      exact=&#123;exact&#125;</span><br><span class=\"line\">      children=&#123;<span class=\"function\">(<span class=\"params\">props</span>) =&gt;</span> (</span><br><span class=\"line\">        &lt;li className=&#123;props.match ? <span class=\"string\">&#x27;active&#x27;</span> : <span class=\"string\">&#x27;&#x27;</span>&#125;&gt;</span><br><span class=\"line\">          &lt;Link to=&#123;to&#125;&gt;&#123;children&#125;&lt;/Link&gt;</span><br><span class=\"line\">        &lt;/li&gt;</span><br><span class=\"line\">      )&#125;</span><br><span class=\"line\">    &gt;&lt;/Route&gt;</span><br><span class=\"line\">  );</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> MenuLink;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Prompt\"><a href=\"#Prompt\" class=\"headerlink\" title=\"Prompt\"></a>Prompt</h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> React, &#123; Component &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> Context <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./context&#x27;</span>;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Prompt</span> <span class=\"keyword\">extends</span> <span class=\"title\">Component</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">static</span> contextType = Context;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"function\"><span class=\"title\">componentWillUnmount</span>(<span class=\"params\"></span>)</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">this</span>.history.block(<span class=\"literal\">null</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"title\">render</span>(<span class=\"params\"></span>)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> history = <span class=\"built_in\">this</span>.context.history;</span><br><span class=\"line\">    <span class=\"keyword\">const</span> &#123; when, messaga &#125; = <span class=\"built_in\">this</span>.props;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (when) &#123;</span><br><span class=\"line\">      history.block(messaga);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">      history.block(<span class=\"literal\">null</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> Prompt;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Redirect\"><a href=\"#Redirect\" class=\"headerlink\" title=\"Redirect\"></a>Redirect</h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; Component &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> Context <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./context&#x27;</span>;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Redirect</span> <span class=\"keyword\">extends</span> <span class=\"title\">Component</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">static</span> contextType = Context;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"title\">render</span>(<span class=\"params\"></span>)</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">this</span>.context.history.push(<span class=\"built_in\">this</span>.props.to);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> Redirect;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Route\"><a href=\"#Route\" class=\"headerlink\" title=\"Route\"></a>Route</h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> PathToRegexp <span class=\"keyword\">from</span> <span class=\"string\">&#x27;path-to-regexp&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> React, &#123; Component &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> Context <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./context&#x27;</span>;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Route</span> <span class=\"keyword\">extends</span> <span class=\"title\">Component</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">static</span> contextType = Context;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"title\">constructor</span>(<span class=\"params\">props</span>)</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">super</span>(props);</span><br><span class=\"line\">    <span class=\"built_in\">this</span>.state = &#123;&#125;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"title\">render</span>(<span class=\"params\"></span>)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> &#123; pathname &#125; = <span class=\"built_in\">this</span>.context.location;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> &#123;</span><br><span class=\"line\">      path = <span class=\"string\">&#x27;/&#x27;</span>,</span><br><span class=\"line\">      component: Component,</span><br><span class=\"line\">      exact = <span class=\"literal\">false</span>,</span><br><span class=\"line\">      render,</span><br><span class=\"line\">      children,</span><br><span class=\"line\">    &#125; = <span class=\"built_in\">this</span>.props;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> paramNames = [];</span><br><span class=\"line\">    <span class=\"keyword\">let</span> regxp = PathToRegexp(path, paramNames, &#123; <span class=\"attr\">end</span>: exact &#125;);</span><br><span class=\"line\">    <span class=\"keyword\">let</span> result = pathname.match(regxp);</span><br><span class=\"line\">    <span class=\"keyword\">let</span> props = &#123;</span><br><span class=\"line\">      location: <span class=\"built_in\">this</span>.context.location,</span><br><span class=\"line\">      history: <span class=\"built_in\">this</span>.props.history,</span><br><span class=\"line\">    &#125;;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (result) &#123;</span><br><span class=\"line\">      paramNames = paramNames.map(<span class=\"function\">(<span class=\"params\">item</span>) =&gt;</span> item.name);</span><br><span class=\"line\">      <span class=\"keyword\">let</span> [url, ...values] = result;</span><br><span class=\"line\">      <span class=\"keyword\">let</span> params = &#123;&#125;;</span><br><span class=\"line\">      <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>; i &lt; paramNames.length; i++) &#123;</span><br><span class=\"line\">        params[paramNames[i]] = values[i];</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      props.match = &#123; params, path, url, <span class=\"attr\">isExect</span>: url === pathname &#125;;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (Component) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">Component</span> &#123;<span class=\"attr\">...props</span>&#125; /&gt;</span></span>;</span><br><span class=\"line\">      &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (render) &#123;</span><br><span class=\"line\">        <span class=\"comment\">/** 检查属性 兼容性 */</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> render(props);</span><br><span class=\"line\">      &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (children) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> children(props);</span><br><span class=\"line\">      &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (children) <span class=\"keyword\">return</span> children(props);</span><br><span class=\"line\">      <span class=\"keyword\">else</span> <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> Route;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"Switch\"><a href=\"#Switch\" class=\"headerlink\" title=\"Switch\"></a>Switch</h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; Component &#125; <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> PathToRegexp <span class=\"keyword\">from</span> <span class=\"string\">&#x27;path-to-regexp&#x27;</span>;</span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Switch</span> <span class=\"keyword\">extends</span> <span class=\"title\">Component</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"title\">constructor</span>(<span class=\"params\">props</span>)</span> &#123;</span><br><span class=\"line\">    <span class=\"built_in\">super</span>(props);</span><br><span class=\"line\">    <span class=\"built_in\">this</span>.state = &#123;&#125;;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"title\">render</span>(<span class=\"params\"></span>)</span> &#123;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> &#123; pathname &#125; = <span class=\"built_in\">this</span>.context.location;</span><br><span class=\"line\">    <span class=\"keyword\">let</span> children = <span class=\"built_in\">Array</span>.isArray(<span class=\"built_in\">this</span>.props.children)</span><br><span class=\"line\">      ? <span class=\"built_in\">this</span>.props</span><br><span class=\"line\">      : [<span class=\"built_in\">this</span>.props.children];</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (<span class=\"keyword\">let</span> i = <span class=\"number\">0</span>; i &lt; children.length; i++) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">let</span> child = children[i];</span><br><span class=\"line\">      <span class=\"keyword\">let</span> &#123; path = <span class=\"string\">&#x27;/&#x27;</span>, exect = <span class=\"literal\">false</span> &#125; = child.props;</span><br><span class=\"line\">      <span class=\"keyword\">let</span> pathNames = [];</span><br><span class=\"line\">      <span class=\"keyword\">let</span> reg = PathToRegexp(path, pathNames, &#123; <span class=\"attr\">end</span>: exect &#125;);</span><br><span class=\"line\">      <span class=\"keyword\">let</span> result = pathname.match(reg);</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (result) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> child; <span class=\"comment\">/** react的元素 React.createElement */</span></span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">null</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> Switch;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"WithRouter\"><a href=\"#WithRouter\" class=\"headerlink\" title=\"WithRouter\"></a>WithRouter</h2><figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> React <span class=\"keyword\">from</span> <span class=\"string\">&#x27;react&#x27;</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> Route <span class=\"keyword\">from</span> <span class=\"string\">&#x27;./Route&#x27;</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// eslint-disable-next-line import/no-anonymous-default-export</span></span><br><span class=\"line\"><span class=\"keyword\">export</span> <span class=\"keyword\">default</span> <span class=\"function\"><span class=\"keyword\">function</span> (<span class=\"params\">WrappedComponent</span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"function\">(<span class=\"params\">props</span>) =&gt;</span> <span class=\"xml\"><span class=\"tag\">&lt;<span class=\"name\">Route</span> <span class=\"attr\">component</span>=<span class=\"string\">&#123;WrappedComponent&#125;</span> /&gt;</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n","feature":null,"text":"BrowserRouter 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676...","link":"","photos":[],"count_time":{"symbolsCount":"9.2k","symbolsTime":"8 mins."},"categories":[{"name":"React","slug":"React","count":7,"path":"api/categories/React.json"}],"tags":[{"name":"React","slug":"React","count":7,"path":"api/tags/React.json"},{"name":"react-router-dom","slug":"react-router-dom","count":1,"path":"api/tags/react-router-dom.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#BrowserRouter\"><span class=\"toc-text\">BrowserRouter</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#context\"><span class=\"toc-text\">context</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#HashRouter\"><span class=\"toc-text\">HashRouter</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Link\"><span class=\"toc-text\">Link</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#MenuLink\"><span class=\"toc-text\">MenuLink</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Prompt\"><span class=\"toc-text\">Prompt</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Redirect\"><span class=\"toc-text\">Redirect</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Route\"><span class=\"toc-text\">Route</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#Switch\"><span class=\"toc-text\">Switch</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#WithRouter\"><span class=\"toc-text\">WithRouter</span></a></li></ol>","author":{"name":"麦当","avatar":"http://image.vulpix.top/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20210326214030.jpg","link":""},"mapped":true,"prev_post":{"title":"react-setState","uid":"89dff2a6379feafc73b36875ccf71035","slug":"react-setState","date":"2021-04-06T14:27:28.394Z","updated":"2021-04-06T14:53:18.661Z","comments":true,"path":"api/articles/react-setState.json","keywords":null,"cover":"http://img-blog.csdnimg.cn/20200716163610402.jpg","text":"react-state 流程 index.js123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263...","link":"","photos":[],"count_time":{"symbolsCount":"3.9k","symbolsTime":"4 mins."},"categories":[{"name":"React","slug":"React","count":7,"path":"api/categories/React.json"}],"tags":[{"name":"React","slug":"React","count":7,"path":"api/tags/React.json"}],"author":{"name":"麦当","avatar":"http://image.vulpix.top/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20210326214030.jpg","link":""}},"next_post":{"title":"react Hooks","uid":"fa08fd35cb36d755ed7492a61cf66138","slug":"react-hook","date":"2021-04-06T14:27:28.370Z","updated":"2021-04-06T14:53:18.661Z","comments":true,"path":"api/articles/react-hook.json","keywords":null,"cover":"http://img-blog.csdnimg.cn/20200716163610402.jpg","text":"useState 每次渲染都是一个独立的闭包 每次渲染都会有自己的 props 和 state 每次渲染后会有自己的时间处理函数 123456789101112131415function Counter() &#123; let [num, setNum] = useState...","link":"","photos":[],"count_time":{"symbolsCount":"1.3k","symbolsTime":"1 mins."},"categories":[{"name":"React","slug":"React","count":7,"path":"api/categories/React.json"}],"tags":[{"name":"React","slug":"React","count":7,"path":"api/tags/React.json"},{"name":"react hook","slug":"react-hook","count":1,"path":"api/tags/react-hook.json"}],"author":{"name":"麦当","avatar":"http://image.vulpix.top/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20210326214030.jpg","link":""}}}